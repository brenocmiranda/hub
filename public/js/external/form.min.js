jQuery(function(e){function t(e){return/^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.?$/i.test(e)}function n(e){return/^(\()?\d{2}(\))?\s?\d{4,5}(\-|\.)?\d{4}$/i.test(e)}function a(t){return new Promise((n,a)=>{e.ajax({url:"https://hub.komuh.com/api/leads/lps",type:"POST",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer 4|GAoYty9d37SKV2EMUhRWG2jKQ3erJFjqP5vWkd6u2d82e33a")},data:t,success:function(e){n(e)},error:function(e,t,n){a(console.log(e))}})})}function o(t,n){e(t).find("input, select, textarea, button").each(function(){e(this).prop("disabled",n),e(this).attr("disabled",n)})}window.formSubmit=function(t){setTimeout(function(){e("form.sending-form").find(".submit-btn").prop("disabled",!0)},10)},e(".no-space").on("keypress",function(e){if(32==e.which)return!1}),e(".is-phone").on("keyup",function(e){var t,n,a=n=(n=(n=(t=this.value).replace(/\D/g,"")).replace(/^0/,"")).length>10?n.replace(/^(\d\d)(\d{5})(\d{4}).*/,"($1) $2-$3"):n.length>5?n.replace(/^(\d\d)(\d{4})(\d{0,4}).*/,"($1) $2-$3"):n.length>2?n.replace(/^(\d\d)(\d{0,5})/,"($1) $2"):n.replace(/^(\d*)/,"($1");a!=this.value&&(this.value=a)}),e(".is-text").on("keyup",function(e){var t,n=(t=this.value).replace(/[^a-zA-Z]/g,"");n!=this.value&&(this.value=n)}),e('[name="pp"]').on("change",function(){e(this).parents("form").find(".submit-btn").prop("disabled",!this.checked)}),window.dataLayer=window.dataLayer||[],e(".submit-btn").prop("disabled",!0).on("click",function(r){r.preventDefault();let u=e(this),s=u.parents("form"),d=s.find(".form-output"),c=s.find('[name="nome"]').val().trim(),m=s.find('[name="email"]').val().trim(),l=s.find('[name="telefone"]').val().trim(),f=s.find('[name="empreendimento"]').val().trim(),p=s.find('[name="sobrenome"]').length>0?s.find('[name="sobrenome"]').val().trim():"",$=s.find('[name="messagem"]').length>0?s.find('[name="messagem"]').val().trim():"",F=s.find('[name="origin"]').length>0?s.find('[name="origin"]').val().trim():"",h=s.find('[name="com"]').length>0?s.find('[name="com"]').val().trim():"",g=s.find('[name="pp"]'),v=location.search?location.search.replace("?",""):"",D=location.href;if(!g.is(":checked")){alert("Aceite da Pol\xedtica de Privacidade \xe9 obrigat\xf3rio.");return}if(""==c||""==m||""==l||""==f){alert("Preencha todos os campos.");return}if(!t(m)){alert("O e-mail fornecido n\xe3o parece v\xe1lido.");return}if(!n(l)){alert("O telefone fornecido n\xe3o parece v\xe1lido.");return}d.length||(s.prepend('<div class="form-output"></div>'),d=s.find(".form-output")),d.html("").removeClass("is-error is-success"),u.addClass("sending"),s.addClass("sending-form"),o(s,!0);let b={nome:c,sobrenome:p,email:m,telefone:l,mensagem:$,empreendimento:f,url_params:v,url:D,origin:F,com:h};console.log("form data",b),a(b).then(function(t){console.log("sendmail",t),t.status&&(u.removeClass("sending"),s[0].reset(),dataLayer.push({event:"conversao_sucesso"}),e(document).trigger("form-sended",[s])),o(s,!1),e("form.sending-form .submit-btn").attr("disabled",!0),s.removeClass("sending-form"),d.html(`<p>${t.status?"Dados enviados com sucesso.":"Erro ao enviar seus dados. Verifique e tente novamente."}</p>`).addClass(t.status?"is-success":"is-error")})}),e(".submit-whatsapp").on("click",function(r){r.preventDefault();let u=e(this),s=u.parents("form"),d=s.find(".form-output-modal"),c=s.find('[name="name"]').val().trim(),m=s.find('[name="email"]').val().trim(),l=s.find('[name="phone"]').val().trim(),f=location.search?location.search.replace("?",""):"",p=location.href,$=s.find('[name="empreendimento"]').val().trim(),F=s.find('[name="tel-whatsapp"]').val().trim(),h=s.find('[name="msg-whatsapp"]').val().trim();if(""==c||""==m||""==l||""==$){alert("Preencha todos os campos.");return}if(!t(m)){alert("O e-mail fornecido n\xe3o parece v\xe1lido.");return}if(!n(l)){alert("O telefone fornecido n\xe3o parece v\xe1lido.");return}d.length||(s.prepend('<div class="form-output-modal"></div>'),d=s.find(".form-output-modal")),d.html("").removeClass("is-error is-success"),u.addClass("sending"),s.addClass("sending-form"),o(s,!0);let g={nome:c,email:m,telefone:l,url_params:f,empreendimento:$,url:p};console.log("form data",g),a(g).then(function(t){console.log("sendmail",t),t.status&&(u.removeClass("sending"),s[0].reset(),dataLayer.push({event:"whatsapp_sucesso"}),e(document).trigger("form-sended",[s])),o(s,!1),e("#myModal").fadeOut(),window.location.href="https://api.whatsapp.com/send/?phone="+F+"&text="+window.encodeURIComponent(h)+"&app_absent=0"})}),e.fn.isInViewport=function(){let t=e(this),n=t.offset().top,a=n+t.outerHeight(),o=e(window),r=o.height(),u=o.scrollTop();return a>u&&n<u+r};let r=e("section, .inview");function u(){r.each(function(){e(this).isInViewport()&&e(this).addClass("is-inview")})}function s(e){d(),e.currentTarget.removeEventListener(e.type,s)}function d(){if(window.gtmDidInit)return!1;window.gtmDidInit=!0,e.getScript("https://www.googletagmanager.com/gtm.js?id="+window.ID_GTM,function(){dataLayer.push({event:"gtm.js","gtm.start":new Date().getTime(),"gtm.uniqueEventId":0})})}e(window).on("resize scroll",u),u(),e(".loading").length&&setTimeout(()=>{e(".loading").fadeOut()},3e3),window.ID_GTM&&(document.addEventListener("DOMContentLoaded",()=>{setTimeout(d,3e3)}),e(document).on("scroll mousemove touchstart click",s)),window.building&&e(".chat").length&&e(".chat").on("click",function(){var t=window.location.toString().split("?");if(t.length>1){var n=t[1].split("&");for(i in n){var a=n[i].split("=");null===sessionStorage.getItem(a[0])&&sessionStorage.setItem(a[0],decodeURIComponent(a[1]))}}var o=sessionStorage.getItem("utm_source")||"",r=sessionStorage.getItem("utm_campaign")||"",u=sessionStorage.getItem("utm_medium")||"";e.getScript("https://www.patrimar.com.br/hotsites/integracoes/chat.php?empreendimento="+window.building+"&url="+window.location.pathname+"&utm_source="+o+"&campanha="+r+"&midia="+u,function(){XRM_Chat.open()})});let c=!1;function m(t){let n=e.extend({iframe:!0,innerWidth:960,innerHeight:540,maxWidth:"90%",maxHeight:"90%",fixed:!0},t);e.colorbox(n)}e("input").on("focus.rcp",function(){let t=this,n=e(this).parents("form"),a=n.find(".submit-btn");c||e.getScript("//www.google.com/recaptcha/api.js",function(){c=!0,n.find("input").each((t,n)=>e(n).off(".rcp")),setTimeout(()=>{e(".submit-btn").prop("disabled",!0),"pp"===t.name&&t.checked&&a.removeProp("disabled")},100)})}),e().colorbox&&(e('a[href*="vimeo.com"]').on("click",function(e){e.preventDefault();let t=/vimeo.*\/(\d+)/i.exec(this.href);t&&m({href:"//player.vimeo.com/video/"+t[1]+"?autoplay=1",innerHeight:402})}),e('a[href*="youtube.com"]').on("click",function(e){e.preventDefault();let t=this.href.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/);t&&11==t[7].length&&m({href:"//www.youtube.com/embed/"+t[7]+"?autoplay=1"})})),window.onetrust&&setTimeout(()=>{let t="https://cdn.cookielaw.org/consent/"+window.onetrust+"/OtAutoBlock.js";e.getScript(t,function(){var e=document.createElement("script");e.type="text/javascript",e.setAttribute("data-domain-script",window.onetrust),e.async=!0,e.src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js";var t=document.getElementsByTagName("body")[0].appendChild(e,t);function n(){}})},2500)});